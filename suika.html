<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <title>ğŸ‰ Anto's Balls</title>
  <link rel="stylesheet" href="style.css">
    <script type="text/javascript" src="jquery-3.3.1.js"></script>
    <script src="script.js"></script>
  <style>
h1 {
            text-align: center;
            margin-top: 20px;
            color: lime;
            font-size: 40px;
            text-shadow: 2px 2px 10px magenta, 0 0 20px yellow;
            animation: wobble 0.8s infinite alternate;
        }

        @keyframes wobble {
            from {
                transform: rotate(-2deg) scale(1.05);
            }

            to {
                transform: rotate(2deg) scale(0.95);
            }
        }

/* Score piÃ¹ visibile e brutto */
#scoreboard {
  font-size: 22px;
  font-weight: bold;
  color: #ff6600;
  text-shadow: 1px 1px #000;
  margin-bottom: 15px;
      padding-left: 30px;

}

/* Canvas piÃ¹ "strano" */
#gameCanvas {
  background-color: #a0f0ff;
  border: 5px dotted #ff00ff;
  border-radius: 15px;
  display: block;
  margin: 0 auto;
  box-shadow: 0 0 20px #ffcc00 inset;
  margin-bottom: 10px;
}

button#startBtn {
  font-size: 18px;
  background: linear-gradient(45deg, #ff00aa, #00ff88);
  color: yellow;
  border: 3px dashed #000;
  border-radius: 15px;
  padding: 8px 20px;
  cursor: pointer;
  text-shadow: 1px 1px #000;
  transition: none;
}

button#startBtn:hover {
  background: linear-gradient(45deg, #00ff88, #ff00aa);
  transform: scale(1.1);
}


/* Istruzioni sparate */
#instructions {
  margin-bottom: 15px;
  font-size: 16px;
  color: #008800;
  font-weight: bold;
  text-shadow: 1px 1px #ffff00;
}


.start-content {
  background: #00ffff;
  border-radius: 25px;
  padding: 40px 50px;
  box-shadow: 0 0 30px #ff00ff;
  text-align: center;
  font-size: 18px;
  color: #ff0088;
}

.container {
            max-width: 1100px;
            margin: 32px auto;
            padding: 20px;
            background: rgba(255, 255, 255, 0.85);
            border: 8px double var(--accent1);
            border-radius: 24px;
            box-shadow: 0 0 40px var(--accent1);
        }
  </style>
</head>
<body>
<div class="navbar">
        <a href="home.html">ğŸˆ Home</a>
        <a href="auguri.html">ğŸ‚ Auguri</a>
        <a href="games.html">ğŸ® Games</a>
            <a href="ecommerce.html">ğŸ›’ eCommerce</a>

        <a href="regali.html">ğŸ Regali</a>
        <a href="contatti.html">âœ¨ Contatti</a>
    </div>
  <h1>ğŸ® Anto's Balls ğŸ‰</h1>
  <div class="container" role="main" aria-labelledby="hubTitle">
<canvas id="gameCanvas" width="400" height="500"></canvas>
  <div id="instructions">â¬…ï¸ Freccia sinistra | â¡ï¸ Freccia destra | Barra spaziatrice per far cadere</div>
  
  

 <!-- Nuovo bottone di partita -->
<div style="margin-top: 15px; display: ruby;">
  <button id="startBtn">ğŸ® Nuova partita</button>
  <div id="scoreboard">Punteggio: <span id="score">0</span></div>
</div>
</div>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/matter-js/0.19.0/matter.min.js"></script>
  <script>
  const { Engine, Render, Runner, World, Bodies, Body, Events } = Matter;

  const engine = Engine.create();
  const world = engine.world;

  const canvas = document.getElementById("gameCanvas");
  const render = Render.create({
    element: document.body,
    canvas,
    engine,
    options: {
      width: 400,
      height: 500,
      background: '#c8e6f5',
      wireframes: false
    }
  });

  Render.run(render);
  const runner = Runner.create();
  let gameStarted = false;
  let gameOver = false;

  // --- MURI ---
  const walls = [
    Bodies.rectangle(200, 525, 400, 50, { isStatic: true }),
    Bodies.rectangle(-5, 300, 10, 600, { isStatic: true }),
    Bodies.rectangle(405, 300, 10, 600, { isStatic: true }),
  ];
  World.add(world, walls);

  // --- LIVELLI (solo colori) ---
  const objectTypes = [
    { name: 'obj1', r: 30, image: 'face1.png' },
    { name: 'obj2', r: 40, image: 'face2.png' },
    { name: 'obj3', r: 50, image: 'face3.png' },
    { name: 'obj4', r: 60, image: 'face4.png' },
    { name: 'obj5', r: 70, image: 'face5.png' } // ultimo livello
  ];

  let current = null;
  let score = 0;
  const scoreEl = document.getElementById("score");
  const startBtn = document.getElementById("startBtn");

  // ğŸ§© Crea un oggetto colorato
  function createObject(type, x = 200, y = 90, isFalling = false) {
    const body = Bodies.circle(x, y, type.r, {
      isStatic: !isFalling,
      restitution: 0.3,
      friction: 0.1,
      density: 0.002,
      render: {
        sprite: {
          texture: type.image,  // ğŸ¯ Usa l'immagine invece del colore
          xScale: 1,
          yScale: 1
        },
        strokeStyle: '#333333',
        lineWidth: 2
      }
    });

    body.label = type.name;
    World.add(world, body);
    return body;
}

  function spawnNewObject() {
    if (gameOver) return;
    const type = objectTypes[Math.floor(Math.random() * 2)];
    current = createObject(type, 200, 50, false);
  }

  // ğŸ® Controlli
  document.addEventListener("keydown", e => {
    if (!current || !gameStarted || gameOver) return;

    if (e.key === "ArrowLeft" && current.position.x - current.circleRadius > 10)
      Body.translate(current, { x: -10, y: 0 });

    if (e.key === "ArrowRight" && current.position.x + current.circleRadius < 390)
      Body.translate(current, { x: 10, y: 0 });

    if (e.key === " ") {
      Body.setStatic(current, false);
      current = null;
      setTimeout(spawnNewObject, 800);
    }
  });

  // ğŸ’¥ Fusione
  Events.on(engine, "collisionStart", event => {
    event.pairs.forEach(pair => {
      const { bodyA, bodyB } = pair;
      if (bodyA.label === bodyB.label) {
        const index = objectTypes.findIndex(o => o.name === bodyA.label);
        const next = objectTypes[index + 1];
        if (next) {
          const newX = (bodyA.position.x + bodyB.position.x) / 2;
          const newY = (bodyA.position.y + bodyB.position.y) / 2;
          World.remove(world, [bodyA, bodyB]);
          createObject(next, newX, newY, true);
          score += 100;
          scoreEl.textContent = score;
        } else {
          World.remove(world, [bodyA, bodyB]);
          score += 500;
          scoreEl.textContent = score;
           setTimeout(() => {
          endGame("Hai vinto! ğŸ‰");
        }, 500);
        }
      }
    });
  });

  // ğŸ•¹ï¸ Game Over per altezza
  Events.on(engine, "afterUpdate", () => {
    if (gameOver) return;
    for (let b of world.bodies) {
      if (!b.isStatic && b.position.y < 30) {
        endGame("Game Over ğŸ’€");
        break;
      }
    }
  });

  function endGame(message) {
    if (gameOver) return;
    gameOver = true;
    alert(`${message}\nPunteggio: ${score}`);
    resetGame();
  }

  function resetGame() {
    // Rimuove tutti gli oggetti tranne i muri
    World.clear(world, false);
    World.add(world, walls);
    score = 0;
    scoreEl.textContent = score;
    gameStarted = false;
    gameOver = false;
    Runner.stop(runner);
    Render.stop(render);
    startScreen.style.display = "flex";
  }

  // --- START SCREEN ---
 startBtn.addEventListener("click", () => {
  if (!gameStarted || gameOver) {
    gameOver = false;
    gameStarted = true;
    Runner.run(runner, engine);
    Render.run(render);
    spawnNewObject();
  }
});

  // Inizia fermo
  Runner.stop(runner);
  startScreen.style.display = "flex";
  </script>
</body>
</html>
